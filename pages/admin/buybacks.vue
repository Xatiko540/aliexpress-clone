<template>
  <AdminLayout>
    <div class="p-6">
      <h2 class="text-2xl font-bold mb-4">–í—ã–∫—É–ø—ã –∫–ª–∏–µ–Ω—Ç–æ–≤</h2>

      <div class="mb-4 bg-white p-4 rounded shadow flex flex-wrap gap-4 items-center">
        <input v-model="searchQuery" type="text" placeholder="üîç ID –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞..." class="border p-2 rounded w-full max-w-xs" />
        <button @click="fetchBuybacks" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
          –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
        </button>
      </div>

      <div class="overflow-x-auto bg-white p-4 rounded shadow">
        <table class="min-w-full text-sm">
          <thead class="bg-gray-200 text-xs uppercase">
            <tr>
              <th class="px-3 py-2">ID</th>
              <th class="px-3 py-2">–¢–æ–≤–∞—Ä</th>
              <th class="px-3 py-2">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
              <th class="px-3 py-2">–ü—Ä–æ—Ü–µ–Ω—Ç</th>
              <th class="px-3 py-2">–ù–∞–≥—Ä–∞–¥–∞</th>
              <th class="px-3 py-2">–î–∞—Ç–∞</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="buyback in filteredBuybacks" :key="buyback.id" class="border-b">
              <td class="px-3 py-2">{{ buyback.id }}</td>
              <td class="px-3 py-2">{{ buyback.product.title }}</td>
              <td class="px-3 py-2">{{ buyback.user.email }}</td>
              <td class="px-3 py-2">{{ buyback.percent }}%</td>
              <td class="px-3 py-2">{{ buyback.reward }} ‚ÇΩ</td>
              <td class="px-3 py-2">{{ buyback.createdAt }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </AdminLayout>
</template>

<script setup>
import AdminLayout from '@/layouts/admin.vue'
import { ref, computed, onMounted } from 'vue'

const buybacks = ref([
  { id: 1, product: { title: '–¢–æ–≤–∞—Ä A' }, user: { email: 'user@example.com' }, percent: 25, reward: 500, createdAt: '2025-06-17' },
  { id: 2, product: { title: '–¢–æ–≤–∞—Ä B' }, user: { email: 'demo@demo.com' }, percent: 30, reward: 750, createdAt: '2025-06-16' },
])
const searchQuery = ref('')

const filteredBuybacks = computed(() => {
  if (!searchQuery.value) return buybacks.value
  return buybacks.value.filter(b =>
    b.product.title.toLowerCase().includes(searchQuery.value.toLowerCase()) ||
    b.user.email.toLowerCase().includes(searchQuery.value.toLowerCase())
  )
})

const fetchBuybacks = () => {
  // –§–µ–π–∫–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —É–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω–∞
}
</script>

